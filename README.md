# Web-приложения для мониторинга и анализа трафика транспортных средств на дорогах
___
## Описание

Web-приложение проводит обработку видеозаписи посредством современных методов компьютерного зрения и выдает аннотированную видеозапись.
Видеозапись с камер дорожного движения загружается зерез пользовательский интерфейс сайта, затем отправляетися на сервер где происходит обработка и трансляция в реальном времени обработанного видео на польховательский интерфейс 
посредством websockets запросов. Приложение реалезует два модуля  - Модуль определения скорости движения транспортных средств, Модуль отслеживания направлений движения транспортных средств на перекрёстках.
## Нейросетевая модель
Для обработки изииображений используется YOLOv8. Предпримемалась поаытка дообучить модель на собственном датасете, но из за скудности датасета полученная модель работала хуже оригенала поэтому принял решение наложить на 
оригенальную модель фильтр по которому бы детектились только 4 класса - легковые авто, грузовики, мотоцыклы, автобусы. Для аннотаций использовалоась библиотека supevision от roboflow.
## Модуль определения скорости движения транспортных средств
Изображение с камеры не передает реальные размеры пространства, поэтому перед измерением скорости нужно учесть перспективу на изображении и знать реальные размеры отслеживаемого участка дороги. 
То есть перед началом расчёта скорости необходимо выполнить преобразование координат с учётом перспективы. 
Реальные размеры участка пользователь должен ввести вручную.
	Для выполнения эти преобразований использовался метод getPerspectiveTransform(source, target) библиотеки OpenCV, который вычисляет матрицу преобразований, 
 здесь source – координаты области на изображении, target – координаты с учетом реальных размеров. И метод perspectiveTransform(points, matrix) из всё той же библиотеки OpenCV,  
 который преобразует массив координат points с помощью матрицы преобразования matrix.
  ```python
  class CoordTransform:
    def init(self, original: np.ndarray, final: np.ndarray) -> None:
        original = original.astype(np.float32)
        final = final.astype(np.float32)
        self.matrix = cv2.getPerspectiveTransform(original,final)

    def transformation(self, points: np.ndarray) -> np.ndarray:
        if points.size == 0:
            return points

        new_points = cv2.perspectiveTransform(points.reshape(-1, 1,        2).astype(np.float32), self.matrix)
        return new_points.reshape(-1, 2)
```
![](https://github.com/nameless1905/track_app/blob/main/Picture1.png)
## Модуль отслеживания направлений движения транспортных средств на перекрёстках
Необходимо собирать данные о маршрутах автомобилей на крестообразном перекрестке. Для этого нужно запоминать откуда автомобиль выехал и в какое направление въехал. 
То есть требуется анализировать его перемещение между зонами входа на перекресток и выхода с перекрестка.
![](https://github.com/nameless1905/track_app/blob/main/Picture2.png)
## Интерфейс
Пользовательский интерфейс написан с помощью фреймворка Vue.js, бэкенд реализован с помощью django.
![](https://github.com/nameless1905/track_app/blob/main/Picture3.png)
![](https://github.com/nameless1905/track_app/blob/main/Picture4.png)
![](https://github.com/nameless1905/track_app/blob/main/Picture5.png)
![](https://github.com/nameless1905/track_app/blob/main/Picture6.png)
![](https://github.com/nameless1905/track_app/blob/main/Picture7.png)
![](https://github.com/nameless1905/track_app/blob/main/Picture8.png)
![](https://github.com/nameless1905/track_app/blob/main/Picture9.png)
